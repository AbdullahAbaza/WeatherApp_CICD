# WeatherApp_CICD
Build and deploy a simple web application on target machines using a CI pipeline.


### Generate And Add A secure ssh key to the target machines to simplify connecting to them by ansible when we run the playbook from jenkins

ssh-keygen -ted25519 -C "Webservers-ssh Key-key generated by AbdullahAbaza"
name it : id_ed25519_webservers_key
mv id_ed25519_webservers_key id_ed25519_webservers_key.pub ./.ssh/ 

#### make sure the old private keys have the correct permitions
chmod 600 ~/.ssh/machines/m01/virtualbox/private_key
chmod 600 ~/.ssh/machines/m02/virtualbox/private_key

#### copy the new key to the machines
cat ~/.ssh/id_ed25519_webservers_key.pub | ssh -i ~/.ssh/machines/m01/virtualbox/private_key vagrant@192.168.73.2 "mkdir -p ~/.ssh && cat >> ~/.ssh/authorized_keys && chmod 600 ~/.ssh/authorized_keys"

cat ~/.ssh/id_ed25519_webservers_key.pub | ssh -i ~/.ssh/machines/m02/virtualbox/private_key vagrant@192.168.73.3 "mkdir -p ~/.ssh && cat >> ~/.ssh/authorized_keys && chmod 600 ~/.ssh/authorized_keys"


        // stage("Execute Ansible") {
        //     steps {
        //         ansiblePlaybook credentialsId: 'webservers-ssh-key',
        //                          disableHostKeyChecking: true,
        //                          installation: 'Ansible',
        //                          inventory: './Ansible/inventory',
        //                          playbook: './Ansible/playbook.yml'
        //     }    
        // }

[webservers-manual-config]
192.168.73.2 ansible_user=vagrant ansible_private_key_file=/home/bazoo/Desktop/WeatherApp_CICD/.sshkeys/m01/private_key
192.168.73.3 ansible_user=vagrant ansible_private_key_file=/home/bazoo/Desktop/WeatherApp_CICD/.sshkeys/m02/private_key